AWSTemplateFormatVersion: '2010-09-09'
Description: AWS CloudFormation Template for launching an EC2 instance

Parameters:
  KeyPairName:
    Description: Name of an existing EC2 KeyPair to enable SSH access to the instance
    Type: 'AWS::EC2::KeyPair::KeyName'
    ConstraintDescription: Must be the name of an existing EC2 KeyPair.
  SubnetId:
    Description: The ID of the subnet where the EC2 instance will be launched
    Type: 'AWS::EC2::Subnet::Id'

Resources:
  MyEC2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      InstanceType: t2.micro
      ImageId: ami-04e5276ebb8451442
      KeyName: !Ref KeyPairName
      NetworkInterfaces:
        - AssociatePublicIpAddress: true
        DeviceIndex: 0
        GroupSet:
          - !Ref WebAccessSecurityGroup
        SubnetId: !Ref SubnetId

  WebAccessSecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: Security Group for web access
      SecurityGroupIngress:
        - IpProtocol: tcp
          FromPort: 80
          ToPort: 80
          CidrIp: 0.0.0.0/0
        - IpProtocol: tcp
          FromPort: 443
          ToPort: 443
          CidrIp: 0.0.0.0/0